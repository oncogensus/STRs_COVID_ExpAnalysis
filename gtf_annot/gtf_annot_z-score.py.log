==========================================
STR Annotation Pipeline Job
Start time: Wed Jan  7 14:59:15 -03 2026
Working directory: /home/matheusbomfim/projects/strs_paper/gtf_annot
==========================================
Executing annotation pipeline...
============================================================
STR ANNOTATION PIPELINE
============================================================

[Step 0] Validating input files...

[Step 1] Reading GTF...
Reading GTF: Homo_sapiens.GRCh38.98.gtf
GTF read: 2895307 rows
Valid chromosomes: 455
Removed 858 records from 23 invalid chromosomes

[Step 2] Creating gene regions...
Creating gene regions...
Saved: ../samples/gp_global/merged/genes.bed (60527 records)
Saved: ../samples/gp_global/merged/exons.bed (1371403 records)
Saved: ../samples/gp_global/merged/CDS.bed (761046 records)
Saved: ../samples/gp_global/merged/five_prime_utr.bed (152662 records)
Saved: ../samples/gp_global/merged/three_prime_utr.bed (153939 records)

[Step 3] Creating special regions...
Creating promoters...
Promoters created: 60527
Creating introns...
Introns created: 288264
Creating intergenic regions...
Intergenic regions: 33244

[Step 4] Processing TSV...
Processing TSV: ../samples/gp_global/merged/outliers_consolidated.tsv
TSV rows: 3333995
Columns: ['sample', 'chrom', 'start', 'end', 'repeat_unit', 'allele1_est', 'allele2_est', 'spanning_reads', 'spanning_pairs', 'left_clips', 'right_clips', 'unplaced_pairs', 'sum_str_counts', 'depth', 'outlier', 'p', 'p_adj']

Created BED with 3333995 STR regions
  Format: 4 columns (chrom, start, end, name)
  Sample chromosomes: ['chr18', 'chr1', 'chr4']

[Step 5] Preparing regions for intersection...

[Step 6] Performing intersections...
Performing intersections...
Total STR regions: 3333995
  Intersecting with CDS...
    STR regions: 3333995
    CDS regions: 761046
    Found 45330 intersections
  Intersecting with five_prime_utr...
    STR regions: 3333995
    five_prime_utr regions: 152662
    Found 41750 intersections
  Intersecting with three_prime_utr...
    STR regions: 3333995
    three_prime_utr regions: 153939
    Found 87797 intersections
  Intersecting with promoter...
    STR regions: 3333995
    promoter regions: 60527
    Found 269120 intersections
  Intersecting with intron...
    STR regions: 3333995
    intron regions: 288264
    Found 2135910 intersections
  Intersecting with intergenic...
    STR regions: 3333995
    intergenic regions: 33244
    Found 1314450 intersections

Intersections completed: 3290467 annotated variants

[Step 7] Identifying unclassified variants...
Total variants: 3333995
Annotated: 3290467
Unannotated: 43528

[Step 8] Adding gene information...
Adding gene information...

[Step 9] Combining with original data...

[Step 10] Calculating statistics...
Calculating statistics...

[Step 11] Saving results...
Saving results...
Main annotations: ../samples/gp_global/merged/outliers_annotated_complete.tsv
Statistics: ../samples/gp_global/merged/outliers_annotation_statistics.tsv

============================================================
PIPELINE COMPLETED SUCCESSFULLY!
Total time: 0:07:38.111108
Variants processed: 3333995
Variants annotated: 3333995

Distribution by region:
  three_prime_utr: 42747 (1.3%)
  promoter: 231676 (6.9%)
  others: 43528 (1.3%)
  five_prime_utr: 23859 (0.7%)
  intron: 1789098 (53.7%)
  intergenic: 1187014 (35.6%)
  CDS: 16073 (0.5%)
============================================================
==========================================
SUCCESS: Pipeline completed at Wed Jan  7 15:07:08 -03 2026
Output files location: ../samples/gp_global/merged/
 - outliers_annotated_complete.tsv
 - outliers_annotation_statistics.tsv
 - gene_statistics.tsv (if applicable)
 - outliers_annotations_simple.tsv (if applicable)
==========================================
