==========================================
STR Annotation Pipeline Job
Start time: Tue Jan  6 11:08:59 -03 2026
Working directory: /home/matheusbomfim/projects/strs_paper/gtf_annot
==========================================
Executing annotation pipeline...
============================================================
STR ANNOTATION PIPELINE
============================================================

[Step 0] Validating input files...

[Step 1] Reading GTF...
Reading GTF: Homo_sapiens.GRCh38.98.gtf
GTF read: 2895307 rows
Valid chromosomes: 455
Removed 858 records from 23 invalid chromosomes

[Step 2] Creating gene regions...
Creating gene regions...
Saved: ../samples/gp_global/merged/genes.bed (60527 records)
Saved: ../samples/gp_global/merged/exons.bed (1371403 records)
Saved: ../samples/gp_global/merged/CDS.bed (761046 records)
Saved: ../samples/gp_global/merged/five_prime_utr.bed (152662 records)
Saved: ../samples/gp_global/merged/three_prime_utr.bed (153939 records)

[Step 3] Creating special regions...
Creating promoters...
Promoters created: 60527
Creating introns...
Introns created: 288264
Creating intergenic regions...
Intergenic regions: 33244

[Step 4] Processing TSV...
Processing TSV: ../samples/gp_global/merged/str_consolidated.tsv
TSV rows: 14961441
Columns: ['sample', 'chrom', 'start', 'end', 'repeat_unit', 'allele1_est', 'allele2_est', 'anchored_reads', 'spanning_reads', 'spanning_pairs', 'expected_spanning_pairs', 'spanning_pairs_pctl', 'left_clips', 'right_clips', 'unplaced_pairs', 'depth']

Created BED with 14961441 STR regions
  Format: 4 columns (chrom, start, end, name)
  Sample chromosomes: ['chr16', 'chr17', 'chr6']

[Step 5] Preparing regions for intersection...

[Step 6] Performing intersections...
Performing intersections...
Total STR regions: 14961441
  Intersecting with CDS...
    STR regions: 14961441
    CDS regions: 761046
    Found 103661 intersections
  Intersecting with five_prime_utr...
    STR regions: 14961441
    five_prime_utr regions: 152662
    Found 105852 intersections
  Intersecting with three_prime_utr...
    STR regions: 14961441
    three_prime_utr regions: 153939
    Found 290139 intersections
  Intersecting with promoter...
    STR regions: 14961441
    promoter regions: 60527
    Found 1077529 intersections
  Intersecting with intron...
    STR regions: 14961441
    intron regions: 288264
    Found 9688468 intersections
  Intersecting with intergenic...
    STR regions: 14961441
    intergenic regions: 33244
    Found 5952121 intersections

Intersections completed: 14830163 annotated variants

[Step 7] Identifying unclassified variants...
Total variants: 14961441
Annotated: 14830163
Unannotated: 131278

[Step 8] Adding gene information...
Adding gene information...

[Step 9] Combining with original data...

[Step 10] Calculating statistics...
Calculating statistics...

[Step 11] Saving results...
Saving results...
Main annotations: ../samples/gp_global/merged/STRs_annotated_complete.tsv
Statistics: ../samples/gp_global/merged/annotation_statistics.tsv

============================================================
PIPELINE COMPLETED SUCCESSFULLY!
Total time: 0:17:20.516987
Variants processed: 14961441
Variants annotated: 14961441

Distribution by region:
  intergenic: 5427454 (36.3%)
  three_prime_utr: 158090 (1.1%)
  others: 131278 (0.9%)
  promoter: 960444 (6.4%)
  five_prime_utr: 61998 (0.4%)
  CDS: 36290 (0.2%)
  intron: 8185887 (54.7%)
============================================================
==========================================
SUCCESS: Pipeline completed at Tue Jan  6 11:26:33 -03 2026
Output files location: ../samples/gp_global/merged/
 - STRs_annotated_complete.tsv
 - annotation_statistics.tsv
 - gene_statistics.tsv (if applicable)
 - STRs_annotations_simple.tsv (if applicable)
==========================================
